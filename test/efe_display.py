import matplotlib.pyplot as plt
import numpy as np


def draw(data):
    data = data[data[:, 4].argsort()]

    colors_list = ['paleturquoise', 'greenyellow', 'orange', 'red', 'black']
    #  colors_list = ['black', 'blue', 'yellow', 'orange', 'red']
    columns_name = ['1_sample', '10_samples', '100_samples', '1000_samples', 'analytical']

    # Plotting both the curves simultaneously
    xs = [x for x in range(data.shape[0])]
    for color_id, y in enumerate(range(data.shape[1])):
        plt.plot(xs, data[:, y], color=colors_list[color_id], label=columns_name[color_id])

    # Naming the x-axis, y-axis and the whole graph
    plt.xlabel("Different Time Step")
    plt.ylabel("Expected Free Energy")
    plt.title("Impact of sampling on expected free energy estimation")

    # Adding legend, which helps us recognize the curve according to it's color
    plt.legend()

    plt.savefig("efe_using_sampling.png")
    plt.show()


if __name__ == '__main__':
    data = np.asarray([
        [16.92211937904358, 12.696872889995575, 13.534098481759429, 12.756728161126375, 12.759742051362991],
        [11.63854530453682, 13.753851145505905, 13.168261011131108, 12.878259252756834, 12.79666069149971],
        [11.636198788881302, 11.107571870088577, 13.120500037446618, 12.655746139585972, 12.783364564180374],
        [11.637372761964798, 11.63737228512764, 12.800790968351066, 12.686889834702015, 12.784759789705276],
        [11.636200219392776, 14.280333817005157, 13.326410999521613, 12.711557012051344, 12.778022080659866],
        [11.56880310177803, 10.668782025575638, 12.670764381065965, 12.477536441758275, 12.324776254594326],
        [11.638534814119339, 13.225014865398407, 12.745203101076186, 12.823035050183535, 12.79657705873251],
        [11.633441239595413, 11.16880539059639, 12.899729320779443, 12.688447883352637, 12.767890349030495],
        [11.63590982556343, 12.699749648571014, 13.059728370048106, 12.918218851089478, 12.770632348954678],
        [11.633446961641312, 12.16227275133133, 12.744611228816211, 12.585749201476574, 12.756609335541725],
        [16.921529054641724, 12.690915316343307, 13.012142877094448, 12.926070116460323, 12.755185209214687],
        [11.638534814119339, 13.753841549158096, 12.63943597394973, 12.766076907515526, 12.796578012406826],
        [16.92416548728943, 12.164725065231323, 12.68969649169594, 12.90300071053207, 12.781565271317959],
        [16.925484895706177, 12.166044473648071, 12.746243530884385, 12.847242202609777, 12.783278070390224],
        [11.635900765657425, 13.222380816936493, 12.856637717224658, 12.708331111818552, 12.775662027299404],
        [11.635632306337357, 12.693285197019577, 12.844634388573468, 12.733366046100855, 12.768637739121914],
        [11.638616353273392, 12.696269303560257, 13.172218898311257, 13.010835248976946, 12.797056756913662],
        [16.92416548728943, 13.751205116510391, 13.059841940179467, 12.822230707854033, 12.781565271317959],
        [11.637217789888382, 12.69487127661705, 13.22386192344129, 12.479808874428272, 12.783278070390224],
        [16.925392389297485, 12.69477865099907, 12.83955828845501, 12.946485014632344, 12.782734952867031],
        [11.564430505037308, 12.086416453123093, 12.630672143772244, 12.535746857523918, 12.463030129671097],
        [11.638525277376175, 12.167351007461548, 12.379518177360296, 12.692419979721308, 12.796864777803421],
        [16.918793439865112, 11.630526334047318, 12.89668120071292, 12.729426369071007, 12.752410680055618],
        [16.92645525932312, 12.695841163396835, 12.688129493035376, 12.734097141772509, 12.793419629335403],
        [11.63302829861641, 12.161854028701782, 12.962151622399688, 12.882596056908369, 12.7645905315876],
        [16.8535635471344, 11.112859964370728, 12.861741084605455, 12.301517218351364, 12.302956849336624],
        [11.638525277376175, 12.167351961135864, 13.013493456877768, 12.807236224412918, 12.796499229967594],
        [12.324514150619507, 12.690486162900925, 12.641275078058243, 12.608925985172391, 12.764380246400833],
        [16.923864126205444, 12.164423286914825, 12.848619984462857, 12.829980798065662, 12.767707139253616],
        [11.632841378450394, 13.74814823269844, 12.529343792237341, 12.720094546675682, 12.751943856477737],
        [11.595257550477982, 11.66257643699646, 12.20761187095195, 12.432155147194862, 12.436926633119583],
        [11.638605386018753, 13.225085496902466, 12.79429180920124, 12.970133834518492, 12.796974636614323],
        [11.632833749055862, 13.219312846660614, 12.952213647775352, 12.849983673542738, 12.764380246400833],
        [16.923864126205444, 12.69324991106987, 12.526587712578475, 12.552117303013802, 12.767707139253616],
        [11.635233670473099, 13.221713721752167, 12.954929580911994, 12.80919399484992, 12.765570908784866],
        [11.632638722658157, 12.690291613340378, 13.00841157604009, 12.892648806795478, 12.76240661740303],
        [11.638525277376175, 12.167351067066193, 12.049514866434038, 12.941779233515263, 12.796864964067936],
        [11.634210377931595, 10.546770840883255, 12.906133266165853, 12.947793094441295, 12.772156029939651],
        [11.638427525758743, 13.224907100200653, 13.43643975816667, 12.89898231625557, 12.79550912976265],
        [11.635585576295853, 13.222065269947052, 12.746946739032865, 12.796260312199593, 12.779235154390335],
        [11.632638722658157, 14.27677184343338, 12.582666359841824, 12.68206762522459, 12.76240661740303],
        [22.215059489011765, 14.282657742500305, 12.904020184651017, 12.7077318392694, 12.796864964067936],
        [11.634210377931595, 13.220690965652466, 12.585858570411801, 12.926632527261972, 12.772156029939651],
        [0.6589601337909698, 12.696080416440964, 12.63576246239245, 12.79734492301941, 12.79550912976265],
        [11.635585576295853, 12.693238466978073, 12.331403511576355, 13.010885901749134, 12.779235154390335],
        [11.635117799043655, 13.750423610210419, 13.011028817854822, 12.765709433704615, 12.764509469270706],
        [11.638605386018753, 12.127253741025925, 12.375107425265014, 12.692357674241066, 12.796974159777164],
        [11.635585576295853, 13.222065210342407, 12.425893927924335, 12.676717033609748, 12.779681950807571],
        [11.63705661892891, 13.752363473176956, 12.693069474771619, 12.776176942512393, 12.781748086214066],
        [11.636863023042679, 13.223343133926392, 12.36648774240166, 12.493876557797194, 12.780603677034378],
        [16.85376286506653, 11.766995191574097, 12.134919386357069, 12.283372543752193, 12.304153710603714],
        [11.638525277376175, 12.167351961135864, 13.119259976781905, 12.860787756741047, 12.796498090028763],
        [16.921294927597046, 13.748335152864456, 12.846685506403446, 12.676145531237125, 12.765435963869095],
        [11.635700017213821, 13.222179651260376, 13.116412408649921, 12.797866882756352, 12.768687039613724],
        [11.633034974336624, 12.690687447786331, 12.161794821731746, 12.88849052786827, 12.753424435853958],
        [11.597596436738968, 13.184077471494675, 11.991792289540172, 12.544451583176851, 12.449595242738724],
        [11.63861158490181, 12.69626447558403, 12.749148469418287, 12.898550380021334, 12.797010213136673],
        [16.921294927597046, 11.06672739982605, 12.115804275497794, 12.712922040373087, 12.765435963869095],
        [11.635700017213821, 14.808659762144089, 12.746234397403896, 12.866149008274078, 12.768687039613724],
        [16.923790216445923, 13.229061990976334, 12.905893468298018, 12.786847710609436, 12.767644673585892],
        [16.88022541999817, 11.759585171937943, 12.225972887128592, 12.533758115023375, 12.41206892579794],
        [11.638600140810013, 11.07100224494934, 12.635277951136231, 12.751323005184531, 12.796926766633987],
        [11.561155587434769, 11.828712284564972, 12.0718250926584, 12.402863938361406, 12.463159166276455],
        [22.174894541502, 12.656014233827591, 12.530118715018034, 12.419028423726559, 12.451144963502884],
        [11.593938142061234, 12.286532580852509, 12.610324457287788, 12.588194891810417, 12.4270144328475],
        [2.7513482868671417, 14.230129092931747, 12.870885119773448, 12.457946196198463, 12.373066030442715],
        [11.638589173555374, 11.638588219881058, 12.586469871923327, 12.638330947607756, 12.796843133866787],
        [22.13104221224785, 12.083335638046265, 12.08223345503211, 12.517542738467455, 12.437153421342373],
        [2.7207219898700714, 14.239220410585403, 12.901657505892217, 12.354341747239232, 12.426555715501308],
        [11.588266640901566, 13.344963937997818, 12.561902734450996, 12.450251607224345, 12.389737211167812],
        [11.565495759248734, 12.784101635217667, 12.509572198614478, 12.344548482447863, 12.304153710603714],
        [11.638525277376175, 14.811485558748245, 12.80193804576993, 12.724497389048338, 12.796498090028763],
        [11.63833025097847, 12.695983201265335, 12.748878963291645, 12.87259902432561, 12.79571607708931],
        [11.638514310121536, 11.63851335644722, 13.013523132540286, 12.920435711741447, 12.796021729707718],
        [11.638329774141312, 12.16715556383133, 12.533626670949161, 12.747596442699432, 12.794932633638382],
        [16.86981749534607, 13.168030500411987, 11.774473601020873, 12.412321534007788, 12.345780745148659],
        [11.638578683137894, 12.696573078632355, 13.009471667930484, 12.761176444590092, 12.796761885285378],
        [11.547454625368118, 12.612077474594116, 12.127544830553234, 12.43805967643857, 12.409881196916103],
        [11.591624051332474, 13.178104102611542, 12.637010724283755, 12.392896856181324, 12.40096129477024],
        [13.348008841276169, 10.348938226699829, 13.04650405421853, 12.434468325227499, 12.350938215851784],
        [11.55911186337471, 12.29611137509346, 12.138586906716228, 12.263911563903093, 12.26533468812704],
        [11.638514786958694, 12.696167200803757, 12.688268618658185, 12.670875053852797, 12.79641655087471],
        [8.948453217744827, 12.618809431791306, 12.204796792939305, 12.475354049354792, 12.463159166276455],
        [11.59836032986641, 12.127187490463257, 12.695794507861137, 12.345295086503029, 12.451144963502884],
        [11.562489777803421, 12.091317474842072, 12.880040189251304, 12.176732245832682, 12.285434804856777],
        [11.561098843812943, 12.354649752378464, 12.812876425683498, 12.468501415103674, 12.448672853410244],
        [11.638515263795853, 13.753822058439255, 12.480950019322336, 12.648718470707536, 12.796796880662441],
        [11.62989929318428, 13.21638035774231, 13.296792981214821, 12.701512135565281, 12.74879577755928],
        [11.638175755739212, 11.639158964157104, 12.80168483685702, 12.775445818901062, 12.793321214616299],
        [11.6326062977314, 12.690259665250778, 12.74745982233435, 12.684614468365908, 12.762061677873135],
        [11.561098843812943, 12.61875268816948, 12.707049049437046, 12.450667941942811, 12.448672853410244],
        [11.638515263795853, 13.22499531507492, 12.533495005220175, 12.998828429728746, 12.796796880662441],
        [16.918166399002075, 12.68755367398262, 12.592536919750273, 12.829908955842257, 12.74879577755928],
        [11.638175755739212, 12.167002499103546, 13.009672717191279, 12.803902890533209, 12.793321691453457],
        [11.6326062977314, 12.690259665250778, 12.690259451977909, 12.775873258709908, 12.762061677873135],
        [11.562277108430862, 13.882144689559937, 12.657545452937484, 12.369075863622129, 12.284164510667324],
        [11.638514786958694, 12.16762188076973, 13.111329477280378, 12.792158782482147, 12.796416364610195],
        [16.926375150680542, 12.695761889219284, 12.957268831320107, 12.717788387089968, 12.79436119645834],
        [11.638397008180618, 13.224876582622528, 12.960466580465436, 12.813150700181723, 12.794871889054775],
        [11.638108521699905, 11.607908487319946, 12.748639221303165, 12.580336686223745, 12.793152891099453]
    ])
    draw(data)
